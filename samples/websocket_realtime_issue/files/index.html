<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script type = "text/javascript" src = "jquery.min.js"></script>
        <script type = "text/javascript" src="bootstrap.bundle.min.js"></script>
        <link rel="stylesheet" type="text/css" href="bootstrap.min.css">
        <script type = "text/javascript" src="nipplejs.min.js"></script>
        <script type = "text/javascript" src="websocket_20240530143334.js"></script>
        <script src="handlebars.min.js"></script>
        <script type = "text/javascript" src="navbar.js"></script>

        <title>BalanceEsp</title>
        <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    </head>

    <style>
input[type="range"] {
    width:300px;
}
    .vgap {
      margin-bottom: 5px; /* Adjust the value to set the vertical distance gap */
    }
    </style>
    <body>
        <div id="navbar-frame"></div>
        <div class="jumbotron jumbotron-fluid">
            <div class="container">
                <!--<h1 class="lead">BalanceEsp</h1><br>-->
                <div class="form-group">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">Roll(deg)</th>
                                <th scope="col">Pitch(deg)</th>
                                <th scope="col">Yaw(deg)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td id="roll">0</td>
                                <td id="pitch">0</td>
                                <td id="yaw">0</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="form-group">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">x(m)</th>
                                <th scope="col">y(m)</th>
                                <th scope="col">theta(deg)</th>
                                <th scope="col">velocity(m/s)</th>
                                <th scope="col">w(deg/s)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td id="odo_x">0</td>
                                <td id="odo_y">0</td>
                                <td id="odo_theta">0</td>
                                <td id="odo_v">0</td>
                                <td id="odo_w">0</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="joystick-container">
                <div id="joystick"></div>
            </div>
        </div>

        <div class="container mt-5">
            <div class="row">
                <div class="col-sm-8"></div>
                <div class="col-sm-4">
                    <div class="progress vgap" id="left_duty_cycle">
                        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%">L</div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-8"></div>
                <div class="col-sm-4">
                <div class="progress vgap" id="right_duty_cycle">
                    <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%">R</div>
                </div>

                </div>
            </div>

        </div>

        <div id="output"></div>
        <script>

            $(document).ready(() => {

                // Initialize WebSocket connection
                WebSocketManager.init();

                            var joystick = nipplejs.create({
                                            zone: document.getElementById('joystick'),
                                            mode: 'static',
                                            size: 100,
                                            threshold: 0.01,
                                            position: { left: '50%', top: '50%' },
                                            color: 'blue'
                                        });
                            joystick.on('move', function(event, data) {
                                            // Joystick is moved
                                            var angle = data.angle.degree;
                                            <!--console.log(data.distance) //left 50, right 50, positive number-->
                                            console.log(data.vector); // unit vector, x, y, useful.
                                            $.getJSON('ajax/joystick', {vec_x: data.vector.x, vec_y: data.vector.y});

                                            // Send the direction to the backend
                                        });
                           joystick.on('start end', function(event, data) {
                                            // Joystick is moved
                                           console.log("joystick start or end")
                                        });


                            <!--(function worker() {-->
                                            <!--$.getJSON('/ajax/ahrs', function(data) {-->
                                                <!--[>$("#roll").text(data.roll);<]-->
                                                <!--[>$("#pitch").text(data.pitch);<]-->
                                                <!--[>$("#yaw").text(data.yaw);<]-->
                                                <!--left_duty_cycle = Math.abs(data.left_duty_cycle)*100;-->
                                                <!--right_duty_cycle = Math.abs(data.right_duty_cycle)*100;-->
                                                <!--[>console.log("left_duty_cycle",left_duty_cycle);<]-->
                                                <!--$("#left_duty_cycle").css('width', left_duty_cycle + '%').attr('aria-valuenow', left_duty_cycle);-->
                                                <!--$("#right_duty_cycle").css('width', right_duty_cycle + '%').attr('aria-valuenow', right_duty_cycle);-->

                                                <!--$("#odo_x").text(data.x);-->
                                                <!--$("#odo_y").text(data.y);-->
                                                <!--$("#odo_theta").text(data.theta);-->
                                                <!--$("#odo_v").text(data.velocity);-->
                                                <!--$("#odo_w").text(data.yaw_rate);-->
                                                <!--setTimeout(worker, 100);-->
                                            <!--});-->
                            <!--})();-->
            });
        </script>
    </body>

</html>
